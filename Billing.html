<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Raj Marketing Mysore - Advanced GST Bill Generator</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
        }
        
        :root {
            --primary: #4361ee;
            --primary-dark: #3a56d4;
            --secondary: #7209b7;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #f94144;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --light-gray: #e9ecef;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            color: var(--dark);
            line-height: 1.6;
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
        }
        
        /* Header Styles */
        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 1px, transparent 1px);
            background-size: 30px 30px;
            opacity: 0.3;
        }
        
        .header-content {
            position: relative;
            z-index: 1;
        }
        
        h1 {
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.2);
        }
        
        .tagline {
            font-size: 1.2rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }
        
        .business-info {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-top: 25px;
            padding-top: 25px;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }
        
        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 1rem;
        }
        
        .info-item i {
            font-size: 1.2rem;
            color: var(--success);
        }
        
        /* Multi-page Navigation */
        .page-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 30px;
            background: white;
            border-radius: 15px;
            padding: 10px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        
        .nav-step {
            display: flex;
            align-items: center;
            padding: 15px 25px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 10px;
            margin: 0 5px;
            font-weight: 500;
        }
        
        .nav-step.active {
            background: var(--primary);
            color: white;
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }
        
        .nav-step.completed {
            background: rgba(67, 97, 238, 0.1);
            color: var(--primary);
        }
        
        .step-number {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 30px;
            height: 30px;
            background: var(--light-gray);
            border-radius: 50%;
            margin-right: 10px;
            font-weight: 600;
        }
        
        .active .step-number {
            background: white;
            color: var(--primary);
        }
        
        .completed .step-number {
            background: var(--success);
            color: white;
        }
        
        /* Page Content */
        .page-content {
            display: none;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            animation: fadeIn 0.5s;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .page-content.active {
            display: block;
        }
        
        .page-title {
            color: var(--primary);
            font-size: 1.8rem;
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--light-gray);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .page-title i {
            color: var(--secondary);
        }
        
        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
        }
        
        .input-with-icon {
            position: relative;
        }
        
        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--gray);
        }
        
        input, select, textarea {
            width: 100%;
            padding: 14px 15px 14px 45px;
            border: 2px solid var(--light-gray);
            border-radius: 10px;
            font-size: 16px;
            transition: all 0.3s;
            color: var(--dark);
        }
        
        textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
        }
        
        /* Additional Charges Section */
        .additional-charges {
            background: rgba(67, 97, 238, 0.05);
            padding: 20px;
            border-radius: 15px;
            margin: 25px 0;
        }
        
        .additional-charges h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.3rem;
        }
        
        .charges-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .charge-item {
            display: flex;
            flex-direction: column;
        }
        
        .charge-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
        }
        
        .charge-type {
            color: var(--gray);
            font-size: 0.9rem;
        }
        
        /* HSN Code Search */
        .hsn-search-container {
            position: relative;
        }
        
        .hsn-search-results {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid var(--light-gray);
            border-radius: 10px;
            max-height: 300px;
            overflow-y: auto;
            z-index: 100;
            display: none;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }
        
        .hsn-search-results.active {
            display: block;
        }
        
        .hsn-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid var(--light-gray);
            cursor: pointer;
            transition: background 0.2s;
        }
        
        .hsn-result-item:hover {
            background: var(--light);
        }
        
        .hsn-code {
            font-weight: 600;
            color: var(--primary);
        }
        
        .hsn-description {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
        }
        
        /* Items Table */
        .items-table-container {
            overflow-x: auto;
            margin-bottom: 30px;
            border-radius: 10px;
            border: 2px solid var(--light-gray);
        }
        
        .items-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .items-table th {
            background: linear-gradient(to right, var(--primary), var(--secondary));
            color: white;
            padding: 16px 15px;
            text-align: left;
            font-weight: 600;
        }
        
        .items-table td {
            padding: 15px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .items-table tr:nth-child(even) {
            background: rgba(67, 97, 238, 0.03);
        }
        
        .items-table tr:hover {
            background: rgba(67, 97, 238, 0.08);
        }
        
        .action-buttons {
            display: flex;
            gap: 8px;
        }
        
        .btn-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            border: none;
            transition: all 0.3s;
            font-size: 1rem;
        }
        
        .btn-edit {
            background: rgba(76, 201, 240, 0.1);
            color: var(--success);
        }
        
        .btn-edit:hover {
            background: var(--success);
            color: white;
        }
        
        .btn-delete {
            background: rgba(249, 65, 68, 0.1);
            color: var(--danger);
        }
        
        .btn-delete:hover {
            background: var(--danger);
            color: white;
        }
        
        /* Bill Preview */
        .bill-preview-container {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            margin-top: 20px;
            border: 2px solid var(--light-gray);
        }
        
        .bill-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--primary);
        }
        
        .invoice-title {
            font-size: 2.2rem;
            color: var(--primary);
            font-weight: 700;
            margin-bottom: 5px;
        }
        
        .bill-details-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        .bill-section h4 {
            color: var(--primary);
            margin-bottom: 15px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--light-gray);
        }
        
        .bill-totals {
            background: linear-gradient(to right, rgba(67, 97, 238, 0.05), rgba(114, 9, 183, 0.05));
            padding: 25px;
            border-radius: 15px;
            margin-top: 30px;
        }
        
        .total-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }
        
        .grand-total {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            border-top: 2px solid var(--light-gray);
            padding-top: 15px;
            margin-top: 10px;
        }
        
        /* Buttons */
        .button-group {
            display: flex;
            justify-content: space-between;
            margin-top: 40px;
            padding-top: 30px;
            border-top: 1px solid var(--light-gray);
        }
        
        .btn {
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            transition: all 0.3s;
            min-width: 150px;
        }
        
        .btn-primary {
            background: linear-gradient(to right, var(--primary), var(--primary-dark));
            color: white;
            box-shadow: 0 5px 15px rgba(67, 97, 238, 0.3);
        }
        
        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
        }
        
        .btn-secondary {
            background: var(--light-gray);
            color: var(--dark);
        }
        
        .btn-secondary:hover {
            background: #d1d9e6;
        }
        
        .btn-success {
            background: linear-gradient(to right, #4cc9f0, #3aa8d0);
            color: white;
            box-shadow: 0 5px 15px rgba(76, 201, 240, 0.3);
        }
        
        .btn-success:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(76, 201, 240, 0.4);
        }
        
        .btn-danger {
            background: linear-gradient(to right, var(--danger), #e02e31);
            color: white;
            box-shadow: 0 5px 15px rgba(249, 65, 68, 0.3);
        }
        
        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(249, 65, 68, 0.4);
        }
        
        /* Footer */
        footer {
            text-align: center;
            margin-top: 30px;
            color: var(--gray);
            font-size: 0.9rem;
            padding: 20px;
        }
        
        /* Responsive Design */
        @media (max-width: 992px) {
            .bill-details-grid {
                grid-template-columns: 1fr;
            }
            
            .form-grid {
                grid-template-columns: 1fr;
            }
            
            .page-navigation {
                flex-direction: column;
                align-items: stretch;
            }
            
            .nav-step {
                margin-bottom: 5px;
            }
        }
        
        @media (max-width: 768px) {
            h1 {
                font-size: 2.2rem;
            }
            
            .button-group {
                flex-direction: column;
                gap: 15px;
            }
            
            .btn {
                width: 100%;
            }
        }
        
        /* Notification */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
            animation: slideIn 0.3s;
            display: none;
        }
        
        .notification.success {
            background-color: #4cc9f0;
        }
        
        .notification.error {
            background-color: #f94144;
        }
        
        .notification.info {
            background-color: #4361ee;
        }
        
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideOut {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }
        
        @media print {
            .page-navigation, .button-group, footer {
                display: none;
            }
            
            .page-content {
                box-shadow: none;
                padding: 0;
            }
            
            body {
                background: white;
                padding: 0;
            }
            
            .additional-charges {
                background: none;
                border: 1px solid #ddd;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="header-content">
                <h1>Raj Marketing Mysore</h1>
                <p class="tagline">Advanced GST Bill Generator with HSN Code Search</p>
                <div class="business-info">
                    <div class="info-item">
                        <i class="fas fa-map-marker-alt"></i>
                        <span>Hootghalli Industries Area, Mysore</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-phone"></i>
                        <span>9483037385</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-envelope"></i>
                        <span>info@rajmarketingmysore.com</span>
                    </div>
                    <div class="info-item">
                        <i class="fas fa-gem"></i>
                        <span>GSTIN: 29ABCDE1234F1Z5</span>
                    </div>
                </div>
            </div>
        </header>
        
        <!-- Multi-page Navigation -->
        <div class="page-navigation">
            <div class="nav-step active" data-page="1">
                <span class="step-number">1</span>
                <span>Customer Details</span>
            </div>
            <div class="nav-step" data-page="2">
                <span class="step-number">2</span>
                <span>Add Items</span>
            </div>
            <div class="nav-step" data-page="3">
                <span class="step-number">3</span>
                <span>Additional Charges</span>
            </div>
            <div class="nav-step" data-page="4">
                <span class="step-number">4</span>
                <span>Review & Generate</span>
            </div>
            <div class="nav-step" data-page="5">
                <span class="step-number">5</span>
                <span>Print Bill</span>
            </div>
        </div>
        
        <!-- Page 1: Customer Details -->
        <div class="page-content active" id="page1">
            <h2 class="page-title"><i class="fas fa-user-circle"></i> Customer Details</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="customerName">Customer Name *</label>
                    <div class="input-with-icon">
                        <i class="fas fa-user"></i>
                        <input type="text" id="customerName" placeholder="Enter customer name" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="customerPhone">Phone Number</label>
                    <div class="input-with-icon">
                        <i class="fas fa-phone"></i>
                        <input type="tel" id="customerPhone" placeholder="Enter phone number">
                    </div>
                </div>
                  <div class="form-group">
                    <label for="customerEmail">Email Address</label>
                    <div class="input-with-icon">
                    <i class="fas fa-envelope"></i>
                        <input type="email" id="customerEmail" placeholder="Enter email address">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="customerGST">GSTIN (if available)</label>
                    <div class="input-with-icon">
                        <i class="fas fa-id-card"></i>
                        <input type="text" id="customerGST" placeholder="Enter GSTIN">
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="customerAddress">Shipping Address *</label>
                <div class="input-with-icon">
                    <i class="fas fa-map-marker-alt"></i>
                    <textarea id="customerAddress" placeholder="Enter complete shipping address" required></textarea>
                </div>
            </div>
            
            <div class="form-group">
                <label for="billingAddress">Billing Address</label>
                <div class="input-with-icon">
                    <i class="fas fa-file-invoice"></i>
                    <textarea id="billingAddress" placeholder="Enter billing address (if different from shipping)"></textarea>
                </div>
            </div>
            
            <div class="button-group">
                <div></div>
                <button class="btn btn-primary" id="nextToPage2">
                    Next <i class="fas fa-arrow-right"></i>
                </button>
            </div>
        </div>
        
        <!-- Page 2: Add Items -->
        <div class="page-content" id="page2">
            <h2 class="page-title"><i class="fas fa-shopping-cart"></i> Add Items to Bill</h2>
            
            <div class="form-grid">
                <div class="form-group">
                    <label for="itemName">Item Name *</label>
                    <div class="input-with-icon">
                        <i class="fas fa-box"></i>
                        <input type="text" id="itemName" placeholder="Enter item name">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="itemHSN">HSN Code *</label>
                    <div class="input-with-icon hsn-search-container">
                        <i class="fas fa-search"></i>
                        <input type="text" id="itemHSN" placeholder="Search or enter HSN code">
                        <div class="hsn-search-results" id="hsnResults">
                            <!-- HSN results will be populated here -->
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="itemQty">Quantity *</label>
                    <div class="input-with-icon">
                        <i class="fas fa-hashtag"></i>
                        <input type="number" id="itemQty" min="1" value="1" step="1">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="itemPrice">Price (₹) *</label>
                    <div class="input-with-icon">
                        <i class="fas fa-rupee-sign"></i>
                        <input type="number" id="itemPrice" min="0" value="0" step="0.01">
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="itemGST">GST Rate (%) *</label>
                    <div class="input-with-icon">
                        <i class="fas fa-percentage"></i>
                        <select id="itemGST">
                            <option value="0">0%</option>
                            <option value="5">5%</option>
                            <option value="12">12%</option>
                            <option value="18" selected>18%</option>
                            <option value="28">28%</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <button class="btn btn-secondary" id="addItemBtn">
                    <i class="fas fa-plus-circle"></i> Add Item
                </button>
                
                <div>
                    <button class="btn btn-secondary" id="backToPage1">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                    <button class="btn btn-primary" id="nextToPage3">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Items Table -->
            <div class="items-table-container">
                <table class="items-table">
                    <thead>
                        <tr>
                            <th>#</th>
                            <th>Item Name</th>
                            <th>HSN Code</th>
                            <th>Qty</th>
                            <th>Price (₹)</th>
                            <th>GST %</th>
                            <th>GST Amt</th>
                            <th>Total (₹)</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="itemsTableBody">
                        <!-- Items will be added here -->
                        <tr id="noItemsRow">
                            <td colspan="9" style="text-align: center; padding: 30px;">
                                <i class="fas fa-box-open" style="font-size: 3rem; color: #ccc; margin-bottom: 15px; display: block;"></i>
                                <p>No items added yet. Add items to your bill.</p>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
        
        <!-- Page 3: Additional Charges -->
        <div class="page-content" id="page3">
            <h2 class="page-title"><i class="fas fa-receipt"></i> Additional Charges</h2>
            
            <div class="additional-charges">
                <h3><i class="fas fa-truck"></i> Shipping & Handling</h3>
                <div class="charges-grid">
                    <div class="charge-item">
                        <div class="charge-label">
                            <label for="shippingCharge">Shipping Charge</label>
                            <span class="charge-type">(₹)</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-rupee-sign"></i>
                            <input type="number" id="shippingCharge" min="0" value="0" step="0.01">
                        </div>
                    </div>
                    
                    <div class="charge-item">
                        <div class="charge-label">
                            <label for="packagingCharge">Packaging Charge</label>
                            <span class="charge-type">(₹)</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-box"></i>
                            <input type="number" id="packagingCharge" min="0" value="0" step="0.01">
                        </div>
                    </div>
                    
                    <div class="charge-item">
                        <div class="charge-label">
                            <label for="insuranceCharge">Insurance Charge</label>
                            <span class="charge-type">(₹)</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-shield-alt"></i>
                            <input type="number" id="insuranceCharge" min="0" value="0" step="0.01">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="additional-charges">
                <h3><i class="fas fa-tags"></i> Discounts & Adjustments</h3>
                <div class="charges-grid">
                    <div class="charge-item">
                        <div class="charge-label">
                            <label for="discountAmount">Discount Amount</label>
                            <span class="charge-type">(₹)</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-percentage"></i>
                            <input type="number" id="discountAmount" min="0" value="0" step="0.01">
                        </div>
                    </div>
                    
                    <div class="charge-item">
                        <div class="charge-label">
                            <label for="discountPercent">Discount Percentage</label>
                            <span class="charge-type">(%)</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-percent"></i>
                            <input type="number" id="discountPercent" min="0" max="100" value="0" step="0.1">
                        </div>
                    </div>
                    
                    <div class="charge-item">
                        <div class="charge-label">
                            <label for="otherCharges">Other Charges</label>
                            <span class="charge-type">(₹)</span>
                        </div>
                        <div class="input-with-icon">
                            <i class="fas fa-plus-circle"></i>
                            <input type="number" id="otherCharges" min="0" value="0" step="0.01">
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="additional-charges">
                <h3><i class="fas fa-info-circle"></i> Summary</h3>
                <div id="chargesSummary">
                    <p>Total items: <span id="summaryItemCount">0</span></p>
                    <p>Subtotal: ₹<span id="summarySubtotal">0.00</span></p>
                    <p>Total GST: ₹<span id="summaryTotalGST">0.00</span></p>
                    <p>Additional charges will be calculated on next page.</p>
                </div>
            </div>
            
            <div class="button-group">
                <div>
                    <button class="btn btn-secondary" id="backToPage2">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                </div>
                <div>
                    <button class="btn btn-primary" id="nextToPage4">
                        Next <i class="fas fa-arrow-right"></i>
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Page 4: Review & Generate -->
        <div class="page-content" id="page4">
            <h2 class="page-title"><i class="fas fa-file-invoice-dollar"></i> Review & Generate Bill</h2>
            
            <div class="bill-preview-container">
                <div class="bill-header">
                    <h3 class="invoice-title">TAX INVOICE</h3>
                    <p>Raj Marketing Mysore</p>
                </div>
                
                <div class="bill-details-grid">
                    <div class="bill-section">
                        <h4>Bill From:</h4>
                        <p><strong>Raj Marketing Mysore</strong></p>
                        <p>Hootghalli Industries Area</p>
                        <p>Mysore, Karnataka</p>
                        <p>Phone: 9483037385</p>
                        <p>GSTIN: 29ABCDE1234F1Z5</p>
                    </div>
                    
                    <div class="bill-section">
                        <h4>Bill To:</h4>
                        <p id="reviewCustomerName">Customer Name</p>
                        <p id="reviewCustomerAddress">Customer Address</p>
                        <p id="reviewCustomerPhone">Phone: </p>
                        <p id="reviewCustomerGST">GSTIN: </p>
                    </div>
                    
                    <div class="bill-section">
                        <h4>Invoice Details:</h4>
                        <p><strong>Invoice #:</strong> <span id="invoiceNumber">RM001</span></p>
                        <p><strong>Invoice Date:</strong> <span id="invoiceDate">DD/MM/YYYY</span></p>
                        <p><strong>Due Date:</strong> <span id="dueDate">DD/MM/YYYY</span></p>
                          </div>
                          <div class="bill-section">
                        <h4>Payment Details:</h4>
                        <p><strong>Status:</strong> <span class="payment-status pending">Pending</span></p>
                        <p><strong>Payment Method:</strong> Bank Transfer</p>
                        <p><strong>Bank Name:</strong> State Bank of India</p>
                        <p><strong>Account No:</strong> 123456789012</p>
                        <p><strong>IFSC Code:</strong> SBIN0001234</p>
                    </div>
                </div>
                
                <!-- Items Table in Bill Preview -->
                <div class="items-table-container">
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Item Description</th>
                                <th>HSN Code</th>
                                <th>Qty</th>
                                <th>Price (₹)</th>
                                <th>GST %</th>
                                <th>GST Amt (₹)</th>
                                <th>Total (₹)</th>
                            </tr>
                        </thead>
                        <tbody id="billPreviewItems">
                            <!-- Bill items will be populated here -->
                        </tbody>
                    </table>
                </div>
                
                <!-- Bill Totals -->
                <div class="bill-totals">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span id="billSubtotal">₹0.00</span>
                    </div>
                    <div class="total-row">
                        <span>Total GST:</span>
                        <span id="billTotalGST">₹0.00</span>
                    </div>
                    
                    <!-- Additional Charges -->
                    <div class="total-row" id="shippingRow" style="display: none;">
                        <span>Shipping Charges:</span>
                        <span id="billShipping">₹0.00</span>
                    </div>
                    <div class="total-row" id="packagingRow" style="display: none;">
                        <span>Packaging Charges:</span>
                        <span id="billPackaging">₹0.00</span>
                    </div>
                    <div class="total-row" id="insuranceRow" style="display: none;">
                        <span>Insurance Charges:</span>
                        <span id="billInsurance">₹0.00</span>
                    </div>
                    <div class="total-row" id="otherChargesRow" style="display: none;">
                        <span>Other Charges:</span>
                        <span id="billOtherCharges">₹0.00</span>
                    </div>
                    
                    <!-- Discounts -->
                    <div class="total-row" id="discountRow" style="display: none;">
                        <span>Discount:</span>
                        <span id="billDiscount">-₹0.00</span>
                    </div>
                    
                    <div class="total-row grand-total">
                        <span>Grand Total:</span>
                        <span id="billGrandTotal">₹0.00</span>
                    </div>
                </div>
            </div>
            
            <div class="button-group">
                <div>
                    <button class="btn btn-secondary" id="backToPage3">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                </div>
                <div>
                    <button class="btn btn-danger" id="resetBillBtn">
                        <i class="fas fa-redo"></i> Reset Bill
                    </button>
                    <button class="btn btn-success" id="generateBillBtn">
                        <i class="fas fa-file-pdf"></i> Generate Bill
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Page 5: Print Bill -->
        <div class="page-content" id="page5">
            <h2 class="page-title"><i class="fas fa-print"></i> Print & Download Bill</h2>
            
            <div class="bill-preview-container">
                <!-- This will be filled with the final bill for printing -->
                <div id="printableBill">
                    <!-- Bill content will be inserted here -->
                </div>
            </div>
            
            <div class="button-group">
                <div>
                    <button class="btn btn-secondary" id="backToPage4">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                </div>
                <div>
                    <button class="btn btn-primary" id="downloadPDFBtn">
                        <i class="fas fa-download"></i> Download as PDF
                    </button>
                    <button class="btn btn-success" id="printBillBtn">
                        <i class="fas fa-print"></i> Print Bill
                    </button>
                </div>
            </div>
        </div>
        
        <!-- Notification Area -->
        <div class="notification" id="notification"></div>
        
        <footer>
            <p>© 2023 Raj Marketing Mysore. All rights reserved. | GST Bill Generator v2.0</p>
            <p>This is a computer-generated invoice and does not require a physical signature.</p>
        </footer>
    </div>

    <script>
        // Application Data
        let currentPage = 1;
        let items = [];
        let invoiceCounter = 1;
        let hsnDatabase = [];
        
        // Additional Charges
        let additionalCharges = {
            shipping: 0,
            packaging: 0,
            insurance: 0,
            discountAmount: 0,
            discountPercent: 0,
            otherCharges: 0
        };
        
        // Sample HSN Code Database
        const hsnCodes = [
            { code: "3301", description: "Essential oils; resinoids" },
            { code: "3302", description: "Mixtures of odoriferous substances" },
            { code: "3303", description: "Perfumes and toilet waters" },
            { code: "3304", description: "Beauty or make-up preparations" },
            { code: "3305", description: "Hair preparations" },
            { code: "3306", description: "Oral hygiene products" },
            { code: "3307", description: "Pre-shave, shaving or after-shave preparations" },
            { code: "3923", description: "Articles for the conveyance or packing of goods" },
            { code: "3924", description: "Tableware, kitchenware, other household articles" },
            { code: "3926", description: "Other articles of plastics" },
            { code: "4016", description: "Articles of vulcanized rubber" },
            { code: "4818", description: "Toilet paper, handkerchiefs, towels" },
            { code: "4823", description: "Paper, paperboard, cellulose wadding" },
            { code: "6109", description: "T-shirts, singlets and other vests" },
            { code: "6110", description: "Sweaters, pullovers, sweatshirts, waistcoats" },
            { code: "6203", description: "Men's or boys' suits, ensembles, jackets" },
            { code: "6204", description: "Women's or girls' suits, ensembles, jackets" },
            { code: "6401", description: "Waterproof footwear" },
            { code: "6402", description: "Footwear with outer soles and uppers of rubber or plastics" },
            { code: "6403", description: "Footwear with outer soles of rubber, plastics, leather" },
            { code: "6404", description: "Footwear with outer soles of leather" },
            { code: "6405", description: "Other footwear" },
            { code: "7013", description: "Glassware of a kind used for table, kitchen, toilet" },
            { code: "7323", description: "Table, kitchen or other household articles" },
            { code: "7324", description: "Sanitary ware and parts thereof" },
            { code: "7326", description: "Other articles of iron or steel" },
            { code: "8471", description: "Automatic data processing machines" },
            { code: "8509", description: "Electro-mechanical domestic appliances" },
            { code: "8516", description: "Electric instantaneous or storage water heaters" },
            { code: "8517", description: "Telephones, including smartphones" },
            { code: "8528", description: "Monitors and projectors" },
            { code: "9401", description: "Seats (other than those of heading 9402)" },
            { code: "9403", description: "Other furniture and parts thereof" },
            { code: "9405", description: "Lamps and lighting fittings" },
            { code: "9503", description: "Tricycles, scooters, pedal cars and similar wheeled toys" },
            { code: "9504", description: "Video game consoles and machines" },
            { code: "9603", description: "Brooms, brushes, hand-operated mechanical floor sweepers" },
            { code: "9615", description: "Combs, hair-slides and the like" },
            { code: "9617", description: "Vacuum flasks and other vacuum vessels" },
            { code: "9618", description: "Tailors' dummies and other mannequins" }
        ];
        
        // DOM Elements
        const pageElements = {
            1: document.getElementById('page1'),
            2: document.getElementById('page2'),
            3: document.getElementById('page3'),
            4: document.getElementById('page4'),
            5: document.getElementById('page5')
        };
        
        const navSteps = document.querySelectorAll('.nav-step');
        
        // Initialize the application
        function initApp() {
            // Set current date
            const today = new Date();
            const formattedDate = formatDate(today);
            document.getElementById('invoiceDate').textContent = formattedDate;
            
            // Set due date (30 days from now)
            const dueDate = new Date(today);
            dueDate.setDate(dueDate.getDate() + 30);
            document.getElementById('dueDate').textContent = formatDate(dueDate);
            
            // Set invoice number
            document.getElementById('invoiceNumber').textContent = `RM${String(invoiceCounter).padStart(3, '0')}`;
            
            // Initialize HSN database
            hsnDatabase = hsnCodes;
            
            // Set up event listeners
            setupEventListeners();
            
            // Add sample data for testing
            setupSampleData();
        }
        
        // Set up sample data for testing
        function setupSampleData() {
            // Add sample customer
            document.getElementById('customerName').value = 'ABC Enterprises';
            document.getElementById('customerPhone').value = '9876543210';
            document.getElementById('customerEmail').value = 'abc@example.com';
            document.getElementById('customerGST').value = '29AAABC1234D1Z5';
            document.getElementById('customerAddress').value = '123 Main Street, Bangalore, Karnataka';
            
            // Add sample items
            setTimeout(() => {
                items = [
                    {
                        id: Date.now(),
                        name: 'Office Chair',
                        hsn: '9401',
                        qty: 2,
                        price: 4500,
                        gstPercent: 18,
                        gstAmount: (2 * 4500 * 18) / 100,
                        total: (2 * 4500) + ((2 * 4500 * 18) / 100)
                    },
                    {
                        id: Date.now() + 1,
                        name: 'Desk Lamp',
                        hsn: '9405',
                        qty: 3,
                        price: 1200,
                        gstPercent: 18,
                        gstAmount: (3 * 1200 * 18) / 100,
                        total: (3 * 1200) + ((3 * 1200 * 18) / 100)
                    }
                ];
                
                // Add sample additional charges
                additionalCharges.shipping = 250;
                additionalCharges.packaging = 100;
                additionalCharges.discountPercent = 5;
                additionalCharges.otherCharges = 50;
                
                // Update form fields
                document.getElementById('shippingCharge').value = additionalCharges.shipping;
                document.getElementById('packagingCharge').value = additionalCharges.packaging;
                document.getElementById('discountPercent').value = additionalCharges.discountPercent;
                document.getElementById('otherCharges').value = additionalCharges.otherCharges;
                
                // Update UI
                updateItemsTable();
                updateChargesSummary();
                
                showNotification('Sample data loaded for testing', 'info');
            }, 500);
        }
        
        // Set up all event listeners
        function setupEventListeners() {
            // Navigation
            document.getElementById('nextToPage2').addEventListener('click', () => navigateTo(2));
            document.getElementById('nextToPage3').addEventListener('click', () => navigateTo(3));
            document.getElementById('nextToPage4').addEventListener('click', () => navigateTo(4));
            
            document.getElementById('backToPage1').addEventListener('click', () => navigateTo(1));
            document.getElementById('backToPage2').addEventListener('click', () => navigateTo(2));
            document.getElementById('backToPage3').addEventListener('click', () => navigateTo(3));
            document.getElementById('backToPage4').addEventListener('click', () => navigateTo(4));
            
            // Navigation steps
            navSteps.forEach(step => {
                step.addEventListener('click', function() {
                    const page = parseInt(this.getAttribute('data-page'));
                    if (page <= currentPage || page === 5) {
                        navigateTo(page);
                    }
                });
            });
            
            // Add item button
            document.getElementById('addItemBtn').addEventListener('click', addItem);
            
            // Additional charges change listeners
            document.getElementById('shippingCharge').addEventListener('change', updateAdditionalCharges);
            document.getElementById('packagingCharge').addEventListener('change', updateAdditionalCharges);
            document.getElementById('insuranceCharge').addEventListener('change', updateAdditionalCharges);
            document.getElementById('discountAmount').addEventListener('change', updateAdditionalCharges);
            document.getElementById('discountPercent').addEventListener('change', updateAdditionalCharges);
            document.getElementById('otherCharges').addEventListener('change', updateAdditionalCharges);
            
            // Generate bill button
            document.getElementById('generateBillBtn').addEventListener('click', generateBill);
            
            // Reset bill button
            document.getElementById('resetBillBtn').addEventListener('click', resetBill);
            
            // Print bill button
            document.getElementById('printBillBtn').addEventListener('click', printBill);
            
            // Download PDF button (simulated)
            document.getElementById('downloadPDFBtn').addEventListener('click', downloadPDF);
            
            // HSN code search
            document.getElementById('itemHSN').addEventListener('input', searchHSNCodes);
            document.getElementById('itemHSN').addEventListener('focus', searchHSNCodes);
            
            // Allow Enter key to add item
            document.getElementById('itemName').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    addItem();
                }
            });
            
            // Update charges summary when items change
            document.getElementById('itemName').addEventListener('change', updateChargesSummary);
            document.getElementById('itemHSN').addEventListener('change', updateChargesSummary);
            document.getElementById('itemQty').addEventListener('change', updateChargesSummary);
            document.getElementById('itemPrice').addEventListener('change', updateChargesSummary);
            document.getElementById('itemGST').addEventListener('change', updateChargesSummary);
        }
        
        // Navigate to a specific page
        function navigateTo(pageNumber) {
            // Validate before leaving page 1
            if (currentPage === 1 && pageNumber > 1) {
                const customerName = document.getElementById('customerName').value.trim();
                const customerAddress = document.getElementById('customerAddress').value.trim();
                
                if (!customerName || !customerAddress) {
                    showNotification('Please fill in all required customer details (name and address)', 'error');
                    return;
                }
            }
            
            // Validate before leaving page 2
            if (currentPage === 2 && pageNumber > 2 && items.length === 0) {
                showNotification('Please add at least one item to the bill', 'error');
                return;
            }
            
            // Update current page
            currentPage = pageNumber;
            
            // Update page visibility
            Object.keys(pageElements).forEach(page => {
                if (parseInt(page) === pageNumber) {
                    pageElements[page].classList.add('active');
                } else {
                    pageElements[page].classList.remove('active');
                }
            });
            
            // Update navigation steps
            navSteps.forEach(step => {
                const stepPage = parseInt(step.getAttribute('data-page'));
                
                step.classList.remove('active', 'completed');
                
                if (stepPage === pageNumber) {
                    step.classList.add('active');
                } else if (stepPage < pageNumber) {
                    step.classList.add('completed');
                }
            });
            
            // If navigating to page 3, update the charges summary
            if (pageNumber === 3) {
                updateChargesSummary();
            }
            
            // If navigating to page 4, update the bill preview
            if (pageNumber === 4) {
                updateBillPreview();
            }
            
            // If navigating to page 5, prepare the printable bill
            if (pageNumber === 5) {
                preparePrintableBill();
            }
        }
        
        // Search HSN codes
        function searchHSNCodes() {
            const searchTerm = document.getElementById('itemHSN').value.toLowerCase();
            const resultsContainer = document.getElementById('hsnResults');
            
            if (searchTerm.length < 2) {
                resultsContainer.classList.remove('active');
                return;
            }
            
            const filteredResults = hsnDatabase.filter(item => 
                item.code.includes(searchTerm) || 
                item.description.toLowerCase().includes(searchTerm)
            ).slice(0, 10);
            
            if (filteredResults.length === 0) {
                resultsContainer.innerHTML = '<div class="hsn-result-item">No results found</div>';
            } else {
                resultsContainer.innerHTML = filteredResults.map(item => `
                    <div class="hsn-result-item" data-code="${item.code}">
                        <div class="hsn-code">${item.code}</div>
                        <div class="hsn-description">${item.description}</div>
                    </div>
                `).join('');
                
                // Add event listeners to result items
                document.querySelectorAll('.hsn-result-item').forEach(item => {
                    item.addEventListener('click', function() {
                        const code = this.getAttribute('data-code');
                        document.getElementById('itemHSN').value = code;
                        resultsContainer.classList.remove('active');
                    });
                });
            }
            
            resultsContainer.classList.add('active');
        }
        
        // Close HSN results when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.hsn-search-container')) {
                document.getElementById('hsnResults').classList.remove('active');
            }
        });
        
        // Add item to the bill
        function addItem() {
            const name = document.getElementById('itemName').value.trim();
            const hsn = document.getElementById('itemHSN').value.trim();
            const qty = parseInt(document.getElementById('itemQty').value);
            const price = parseFloat(document.getElementById('itemPrice').value);
            const gstPercent = parseFloat(document.getElementById('itemGST').value);
            
            // Validation
            if (!name || !hsn || qty <= 0 || price <= 0) {
                showNotification('Please fill in all item details correctly', 'error');
                return;
            }
            
            // Check if HSN code is valid (4 or 6-8 digits)
            if (!/^\d{4,8}$/.test(hsn)) {
                showNotification('Please enter a valid HSN code (4-8 digits)', 'error');
                return;
            }
            
            // Calculate GST and total
            const gstAmount = (qty * price * gstPercent) / 100;
            const total = (qty * price) + gstAmount;
            
            // Create item object
            const item = {
                id: Date.now(),
                name,
                hsn,
                qty,
                price,
                gstPercent,
                gstAmount,
                total
            };
            
            // Add to items array
            items.push(item);
            
            // Update the items table
            updateItemsTable();
            
            // Update charges summary
            updateChargesSummary();
            
            // Clear the form
            clearItemForm();
            
            // Show success message
            showNotification('Item added successfully!', 'success');
        }
        
        // Update items table
        function updateItemsTable() {
            const tableBody = document.getElementById('itemsTableBody');
            
            if (items.length === 0) {
                tableBody.innerHTML = `
                    <tr id="noItemsRow">
                        <td colspan="9" style="text-align: center; padding: 30px;">
                            <i class="fas fa-box-open" style="font-size: 3rem; color: #ccc; margin-bottom: 15px; display: block;"></i>
                            <p>No items added yet. Add items to your bill.</p>
                        </td>
                    </tr>
                `;
                return;
            }
            
            // Remove the "no items" row if it exists
            const noItemsRow = document.getElementById('noItemsRow');
            if (noItemsRow) noItemsRow.remove();
            
            // Build table rows
            tableBody.innerHTML = items.map((item, index) => `
                <tr>
                    <td>${index + 1}</td>
                    <td>${item.name}</td>
                    <td>${item.hsn}</td>
                    <td>${item.qty}</td>
                    <td>${formatCurrency(item.price)}</td>
                    <td>${item.gstPercent}%</td>
                    <td>${formatCurrency(item.gstAmount)}</td>
                    <td>${formatCurrency(item.total)}</td>
                    <td>
                        <div class="action-buttons">
                            <button class="btn-icon btn-edit" onclick="editItem(${item.id})">
                                <i class="fas fa-edit"></i>
                            </button>
                            <button class="btn-icon btn-delete" onclick="deleteItem(${item.id})">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                    </td>
                </tr>
            `).join('');
        }
        
        // Edit item
        function editItem(itemId) {
            const item = items.find(item => item.id === itemId);
            if (!item) return;
            
            // Fill the form with item data
            document.getElementById('itemName').value = item.name;
            document.getElementById('itemHSN').value = item.hsn;
            document.getElementById('itemQty').value = item.qty;
            document.getElementById('itemPrice').value = item.price;
            document.getElementById('itemGST').value = item.gstPercent;
            
            // Remove the item from the list
            deleteItem(itemId, false);
            
            // Scroll to the form
            document.getElementById('itemName').focus();
            
            showNotification('Item loaded for editing', 'info');
        }
        
        // Delete item
        function deleteItem(itemId, showNotification = true) {
            items = items.filter(item => item.id !== itemId);
            updateItemsTable();
            updateChargesSummary();
            
            if (showNotification) {
                showNotification('Item deleted', 'info');
            }
        }
        
        // Clear item form
        function clearItemForm() {
            document.getElementById('itemName').value = '';
            document.getElementById('itemHSN').value = '';
            document.getElementById('itemQty').value = 1;
            document.getElementById('itemPrice').value = 0;
            document.getElementById('itemGST').value = 18;
            document.getElementById('itemName').focus();
        }
        
        // Update additional charges
        function updateAdditionalCharges() {
            // Get values from form
            additionalCharges.shipping = parseFloat(document.getElementById('shippingCharge').value) || 0;
            additionalCharges.packaging = parseFloat(document.getElementById('packagingCharge').value) || 0;
            additionalCharges.insurance = parseFloat(document.getElementById('insuranceCharge').value) || 0;
            additionalCharges.discountAmount = parseFloat(document.getElementById('discountAmount').value) || 0;
            additionalCharges.discountPercent = parseFloat(document.getElementById('discountPercent').value) || 0;
            additionalCharges.otherCharges = parseFloat(document.getElementById('otherCharges').value) || 0;
            
            // Update charges summary
            updateChargesSummary();
        }
        
        // Update charges summary on page 3
        function updateChargesSummary() {
            // Calculate item totals
            const subtotal = items.reduce((sum, item) => sum + (item.qty * item.price), 0);
            const totalGST = items.reduce((sum, item) => sum + item.gstAmount, 0);
            
            // Update summary display
            document.getElementById('summaryItemCount').textContent = items.length;
            document.getElementById('summarySubtotal').textContent = formatNumber(subtotal);
            document.getElementById('summaryTotalGST').textContent = formatNumber(totalGST);
        }
        
        // Update bill preview on page 4
        function updateBillPreview() {
            // Update customer details
            document.getElementById('reviewCustomerName').textContent = 
                document.getElementById('customerName').value;
            document.getElementById('reviewCustomerAddress').textContent = 
                document.getElementById('customerAddress').value;
            
            const phone = document.getElementById('customerPhone').value;
            document.getElementById('reviewCustomerPhone').textContent = 
                phone ? `Phone: ${phone}` : '';
            
            const gst = document.getElementById('customerGST').value;
            document.getElementById('reviewCustomerGST').textContent = 
                gst ? `GSTIN: ${gst}` : '';
            
            // Update bill items
            const billItemsContainer = document.getElementById('billPreviewItems');
            
            if (items.length === 0) {
                billItemsContainer.innerHTML = `
                    <tr>
                        <td colspan="8" style="text-align: center; padding: 30px;">
                            No items added
                        </td>
                    </tr>
                `;
            } else {
                billItemsContainer.innerHTML = items.map((item, index) => `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.name}</td>
                        <td>${item.hsn}</td>
                        <td>${item.qty}</td>
                        <td>${formatCurrency(item.price)}</td>
                        <td>${item.gstPercent}%</td>
                        <td>${formatCurrency(item.gstAmount)}</td>
                        <td>${formatCurrency(item.total)}</td>
                    </tr>
                `).join('');
            }
            
            // Calculate totals
            const subtotal = items.reduce((sum, item) => sum + (item.qty * item.price), 0);
            const totalGST = items.reduce((sum, item) => sum + item.gstAmount, 0);
            
            // Get additional charges
            const shipping = additionalCharges.shipping;
            const packaging = additionalCharges.packaging;
            const insurance = additionalCharges.insurance;
            const otherCharges = additionalCharges.otherCharges;
            
            // Calculate discount
            let discount = additionalCharges.discountAmount;
            if (additionalCharges.discountPercent > 0) {
                discount += (subtotal * additionalCharges.discountPercent) / 100;
            }
            
            // Calculate grand total
            const grandTotal = subtotal + totalGST + shipping + packaging + insurance + otherCharges - discount;
            
            // Update totals display
            document.getElementById('billSubtotal').textContent = formatCurrency(subtotal);
            document.getElementById('billTotalGST').textContent = formatCurrency(totalGST);
            
            // Show/hide and update additional charges rows
            updateChargeRow('shippingRow', 'billShipping', shipping, 'Shipping Charges:');
            updateChargeRow('packagingRow', 'billPackaging', packaging, 'Packaging Charges:');
            updateChargeRow('insuranceRow', 'billInsurance', insurance, 'Insurance Charges:');
            updateChargeRow('otherChargesRow', 'billOtherCharges', otherCharges, 'Other Charges:');
            
            // Update discount row
            if (discount > 0) {
                document.getElementById('discountRow').style.display = 'flex';
                document.getElementById('billDiscount').textContent = `-${formatCurrency(discount)}`;
            } else {
                document.getElementById('discountRow').style.display = 'none';
            }
            
            // Update grand total
            document.getElementById('billGrandTotal').textContent = formatCurrency(grandTotal);
        }
        
        // Helper function to update charge rows
        function updateChargeRow(rowId, amountId, amount, label) {
            const row = document.getElementById(rowId);
            if (amount > 0) {
                row.style.display = 'flex';
                document.getElementById(amountId).textContent = formatCurrency(amount);
            } else {
                row.style.display = 'none';
            }
        }
        
        // Generate the final bill
        function generateBill() {
            if (items.length === 0) {
                showNotification('Please add at least one item to the bill', 'error');
                return;
            }
            
            // Update invoice number for the next bill
            invoiceCounter++;
            document.getElementById('invoiceNumber').textContent = `RM${String(invoiceCounter).padStart(3, '0')}`;
            
            // Navigate to print page
            navigateTo(5);
            
            showNotification('Bill generated successfully!', 'success');
        }
        
        // Prepare printable bill content
        function preparePrintableBill() {
            const printableBill = document.getElementById('printableBill');
            
            // Calculate totals
            const subtotal = items.reduce((sum, item) => sum + (item.qty * item.price), 0);
            const totalGST = items.reduce((sum, item) => sum + item.gstAmount, 0);
            
            // Get additional charges
            const shipping = additionalCharges.shipping;
            const packaging = additionalCharges.packaging;
            const insurance = additionalCharges.insurance;
            const otherCharges = additionalCharges.otherCharges;
            
            // Calculate discount
            let discount = additionalCharges.discountAmount;
            if (additionalCharges.discountPercent > 0) {
                discount += (subtotal * additionalCharges.discountPercent) / 100;
            }
            
            // Calculate grand total
            const grandTotal = subtotal + totalGST + shipping + packaging + insurance + otherCharges - discount;
            
            // Get customer details
            const customerName = document.getElementById('customerName').value;
            const customerAddress = document.getElementById('customerAddress').value;
            const customerPhone = document.getElementById('customerPhone').value;
            const customerGST = document.getElementById('customerGST').value;
            
            // Build printable bill HTML
            printableBill.innerHTML = `
                <div class="bill-header">
                    <h3 class="invoice-title">TAX INVOICE</h3>
                    <p>Raj Marketing Mysore</p>
                </div>
                
                <div class="bill-details-grid">
                    <div class="bill-section">
                        <h4>Bill From:</h4>
                        <p><strong>Raj Marketing Mysore</strong></p>
                        <p>Hootghalli Industries Area</p>
                        <p>Mysore, Karnataka</p>
                        <p>Phone: 9483037385</p>
                        <p>GSTIN: 29ABCDE1234F1Z5</p>
                    </div>
                    
                    <div class="bill-section">
                        <h4>Bill To:</h4>
                        <p><strong>${customerName}</strong></p>
                        <p>${customerAddress}</p>
                        ${customerPhone ? `<p>Phone: ${customerPhone}</p>` : ''}
                        ${customerGST ? `<p>GSTIN: ${customerGST}</p>` : ''}
                    </div>
                    
                    <div class="bill-section">
                        <h4>Invoice Details:</h4>
                        <p><strong>Invoice #:</strong> RM${String(invoiceCounter-1).padStart(3, '0')}</p>
                        <p><strong>Invoice Date:</strong> ${document.getElementById('invoiceDate').textContent}</p>
                        <p><strong>Due Date:</strong> ${document.getElementById('dueDate').textContent}</p>
                    </div>
                    
                    <div class="bill-section">
                        <h4>Payment Details:</h4>
                        <p><strong>Status:</strong> Pending</p>
                        <p><strong>Payment Method:</strong> Bank Transfer</p>
                        <p><strong>Bank Name:</strong> State Bank of India</p>
                        <p><strong>Account No:</strong> 123456789012</p>
                        <p><strong>IFSC Code:</strong> SBIN0001234</p>
                    </div>
                </div>
                
                <div class="items-table-container">
                    <table class="items-table">
                        <thead>
                            <tr>
                                <th>#</th>
                                <th>Item Description</th>
                                <th>HSN Code</th>
                                <th>Qty</th>
                                <th>Price (₹)</th>
                                <th>GST %</th>
                                <th>GST Amt (₹)</th>
                                <th>Total (₹)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${items.map((item, index) => `
                                <tr>
                                    <td>${index + 1}</td>
                                    <td>${item.name}</td>
                                    <td>${item.hsn}</td>
                                    <td>${item.qty}</td>
                                    <td>${formatCurrency(item.price)}</td>
                                    <td>${item.gstPercent}%</td>
                                    <td>${formatCurrency(item.gstAmount)}</td>
                                    <td>${formatCurrency(item.total)}</td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                
                <div class="bill-totals">
                    <div class="total-row">
                        <span>Subtotal:</span>
                        <span>${formatCurrency(subtotal)}</span>
                    </div>
                    <div class="total-row">
                        <span>Total GST:</span>
                        <span>${formatCurrency(totalGST)}</span>
                    </div>
                    
                    ${shipping > 0 ? `
                    <div class="total-row">
                        <span>Shipping Charges:</span>
                        <span>${formatCurrency(shipping)}</span>
                    </div>` : ''}
                    
                    ${packaging > 0 ? `
                    <div class="total-row">
                        <span>Packaging Charges:</span>
                        <span>${formatCurrency(packaging)}</span>
                    </div>` : ''}
                    
                    ${insurance > 0 ? `
                    <div class="total-row">
                        <span>Insurance Charges:</span>
                        <span>${formatCurrency(insurance)}</span>
                    </div>` : ''}
                    
                    ${otherCharges > 0 ? `
                    <div class="total-row">
                        <span>Other Charges:</span>
                        <span>${formatCurrency(otherCharges)}</span>
                    </div>` : ''}
                    
                    ${discount > 0 ? `
                    <div class="total-row">
                        <span>Discount:</span>
                                <span>-${formatCurrency(discount)}</span>
                    </div>` : ''}
                    
                    <div class="total-row grand-total">
                        <span>Grand Total:</span>
                        <span>${formatCurrency(grandTotal)}</span>
                    </div>
                </div>
                
                <div style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd;">
                    <p><strong>Terms & Conditions:</strong></p>
                    <p>1. Goods once sold will not be taken back.</p>
                    <p>2. Payment due within 30 days from invoice date.</p>
                    <p>3. Interest @ 18% p.a. will be charged on overdue payments.</p>
                    <p>4. All disputes subject to Mysore jurisdiction.</p>
                </div>
                
                <div style="margin-top: 30px; display: flex; justify-content: space-between;">
                    <div>
                        <p>_______________________</p>
                        <p>Customer Signature</p>
                    </div>
                    <div>
                        <p>_______________________</p>
                        <p>For Raj Marketing Mysore</p>
                        <p>Authorized Signatory</p>
                    </div>
                </div>
                
                <div style="text-align: center; margin-top: 40px; color: #666; font-size: 0.9rem;">
                    <p>This is a computer-generated invoice and does not require a physical signature.</p>
                    <p>Thank you for your business!</p>
                </div>
            `;
        }
        
        // Print the bill
        function printBill() {
            window.print();
        }
        
        // Download as PDF (simulated)
        function downloadPDF() {
            showNotification('PDF download would be available in a full implementation', 'info');
        }
        
        // Reset the entire bill
        function resetBill() {
            if (confirm('Are you sure you want to reset the entire bill? All data will be lost.')) {
                // Reset form fields
                document.getElementById('customerName').value = '';
                document.getElementById('customerPhone').value = '';
                document.getElementById('customerEmail').value = '';
                document.getElementById('customerGST').value = '';
                document.getElementById('customerAddress').value = '';
                document.getElementById('billingAddress').value = '';
                
                // Reset additional charges
                document.getElementById('shippingCharge').value = 0;
                document.getElementById('packagingCharge').value = 0;
                document.getElementById('insuranceCharge').value = 0;
                document.getElementById('discountAmount').value = 0;
                document.getElementById('discountPercent').value = 0;
                document.getElementById('otherCharges').value = 0;
                
                // Reset charges object
                additionalCharges = {
                    shipping: 0,
                    packaging: 0,
                    insurance: 0,
                    discountAmount: 0,
                    discountPercent: 0,
                    otherCharges: 0
                };
                
                // Clear items
                items = [];
                updateItemsTable();
                clearItemForm();
                updateChargesSummary();
                
                // Reset to page 1
                navigateTo(1);
                
                showNotification('Bill reset successfully', 'info');
            }
        }
        
        // Utility Functions
        function formatDate(date) {
            const day = String(date.getDate()).padStart(2, '0');
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const year = date.getFullYear();
            return `${day}/${month}/${year}`;
        }
        
        function formatCurrency(amount) {
            return new Intl.NumberFormat('en-IN', {
                style: 'currency',
                currency: 'INR',
                minimumFractionDigits: 2
            }).format(amount);
        }
        
        function formatNumber(amount) {
            return new Intl.NumberFormat('en-IN', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(amount);
        }
        
        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            notification.textContent = message;
            notification.className = `notification ${type}`;
            notification.style.display = 'block';
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.style.animation = 'slideOut 0.3s';
                setTimeout(() => {
                    notification.style.display = 'none';
                    notification.style.animation = '';
                }, 300);
            }, 3000);
        }
        
        // Initialize the app when page loads
        window.addEventListener('DOMContentLoaded', initApp);
    </script>
</body>
</html>
